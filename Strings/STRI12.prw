#INCLUDE "Totvs.ch"

//? Testado e ok.

/*/{Protheus.doc} STRI12
Valida e corrige número de telefone. Faça um programa que leia um número de telefone, e corrija o número no caso deste conter somente 7 dígitos, 
acrescentando o '3' na frente. O usuário pode informar o número com ou sem o traço separador.

Valida e corrige número de telefone
Telefone: 461-0133
Telefone possui 7 dígitos. Vou acrescentar o digito três na frente.
Telefone corrigido sem formatação: 34610133
Telefone corrigido com formatação: 3461-0133
@type function
@author Ruan Henrique
@since 1/17/2024
/*/

User Function STRI12()

    Local cTelefone  := ""
    Local cTelNum    := ""
    Local cTelCerto  := ""
    Local cTelFormat := ""
    Local nCont      := 0
    Local nDigitos   := 0

    cTelefone := FwInputBox("Digite o número de telefone: ")

    //? Remove caracteres não numéricos do telefone
    For nCont := 1 To Len(cTelefone)
        If Substr(cTelefone, nCont, 1) >= "0" .And. Substr(cTelefone, nCont, 1) <= "9"
            cTelNum += Substr(cTelefone, nCont, 1)
        EndIf
    Next

    nDigitos := Len(cTelNum)

    If nDigitos == 7
        //? Acrescenta '3' na frente do número
        cTelCerto := "3" + cTelNum

        //? Formata o número corrigido
        cTelFormat := SubStr(cTelCerto, 1, 4) + "-" + SubStr(cTelCerto, 5)
    Else
        //? Mantém o número original se não tiver 7 dígitos
        cTelFormat := SubStr(cTelNum, 1, 3) + "-" + SubStr(cTelNum, 4)
    EndIf

    FwAlertInfo("Telefone corrigido: " + cTelFormat)

Return

